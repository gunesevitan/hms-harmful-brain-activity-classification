dataset:
  dataset_type: 'eeg_spectrogram'
  eeg_dataset: 'eeg_subsample'
  spectrogram_dataset: 'spectrogram_subsample'
  eeg_spectrogram_dataset: 'eeg_spectrograms'
  normalize_targets: True
  top_n_samples: 2

model:
  model_class: 'EfficientNetClassificationModel'
  model_args:
    model_name: 'efficientnetv2_rw_t'
    pretrained: True
    backbone_args:
      in_chans: 4
      drop_rate: 0.1
      drop_path_rate: 0.1
    pooling_type: 'avg'
    dropout_rate: 0
    freeze_parameters: False
    head_args:
      output_dimensions: 6
  model_checkpoint_path: null

training:
  folds: ['fold1', 'fold2', 'fold3', 'fold4', 'fold5']
  #folds: ['fold4', 'fold5']
  loss_function: 'KLDivWithLogitsLoss'
  loss_function_args: {}
  training_batch_size: 64
  test_batch_size: 128
  num_workers: 16
  random_state: 42
  deterministic_cudnn: False
  device: 'cuda'
  optimizer: 'AdamW'
  optimizer_args:
    lr: 0.0005
    betas: [0.9, 0.999]
    weight_decay: 0.00001
  lr_scheduler: 'StepLR'
  lr_scheduler_args:
    gamma: 1.0
    step_size: 1000000000
    last_epoch: -1
    verbose: False
  amp: True
  epochs: 10
  early_stopping_patience: 999

test:
  folds: ['fold1', 'fold2', 'fold3', 'fold4', 'fold5']
  model_file_names: ['model_fold1_best.pt', 'model_fold2_best.pt', 'model_fold3_best.pt', 'model_fold4_best.pt', 'model_fold5_best.pt']
  #folds: ['fold5']
  #model_file_names: ['model_fold5_best.pt']
  tta: True
  tta_flip_dimensions: [[2], [3], [2, 3]]

transforms:
    crop_height: 400
    crop_width: 288
    resize_height: 400
    resize_width: 300
    horizontal_flip_probability: 0.5
    vertical_flip_probability: 0.5
    brightness_limit: 0.2
    contrast_limit: 0.2
    random_brightness_contrast_probability: 0.25
    n_frequencies: 8
    n_consecutive: 0
    frequency_dropout_probability: 0.1
    center_n_time_steps: 1
    center_10_second_dropout_probability: 0.1
    safe_n_time_steps: 4
    safe_time_dropout_probability: 0.0

persistence:
  model_directory: experiment
  save_epoch_model: []